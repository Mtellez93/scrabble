<!DOCTYPE html>
<html>
<head>
    <title>Scrabble TV</title>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { background: #1a1a1a; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        .grid-container { display: grid; grid-template-columns: 40px 1fr; grid-template-rows: 40px 1fr; }
        .coords-h { grid-column: 2; display: flex; }
        .coords-v { grid-row: 2; display: flex; flex-direction: column; }
        .label { width: 45px; height: 40px; display: flex; align-items: center; justify-content: center; color: #f1c40f; font-weight: bold; }
        .v-label { height: 45px; width: 40px; }
        #board { display: grid; grid-template-columns: repeat(15, 45px); grid-template-rows: repeat(15, 45px); gap: 2px; background: #34495e; padding: 5px; }
        .cell { width: 45px; height: 45px; background: #ecf0f1; color: #2c3e50; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.1em; }
        .tp { background: #e74c3c !important; } .dp { background: #ff7675 !important; }
        .bingo-alert { position: fixed; top: 20%; background: #f1c40f; color: black; padding: 20px; font-size: 3em; font-weight: bold; border-radius: 10px; display: none; z-index: 10; animation: pop 1s; }
        @keyframes pop { 0% { transform: scale(0); } 100% { transform: scale(1.2); } }
        .active-player { border: 4px solid #f1c40f; padding: 10px; background: #2c3e50; }
    </style>
</head>
<body>
    <div id="bingo" class="bingo-alert">Â¡BINGO! +50 pts</div>
    <h1>SALA: <span id="room-id">--</span></h1>
    <div class="grid-container">
        <div></div>
        <div id="h-labels" class="coords-h"></div>
        <div id="v-labels" class="coords-v"></div>
        <div id="board"></div>
    </div>
    <div id="players" style="display:flex; gap:20px; margin-top:20px;"></div>

    <script>
        const socket = io();
        const board = document.getElementById('board');
        const hL = document.getElementById('h-labels'), vL = document.getElementById('v-labels');
        
        for(let i=0; i<15; i++) {
            hL.innerHTML += `<div class="label">${i}</div>`;
            vL.innerHTML += `<div class="label v-label">${i}</div>`;
            for(let j=0; j<15; j++) {
                const c = document.createElement('div');
                c.className = 'cell'; c.id = `cell-${j}-${i}`;
                if ((j==0||j==14)&&(i==0||i==14)) c.classList.add('tp');
                board.appendChild(c);
            }
        }

        socket.emit('create-game');
        socket.on('game-created', code => document.getElementById('room-id').innerText = code);
        socket.on('update-game-state', s => {
            document.getElementById('players').innerHTML = s.players.map(p => `<div class="${p.id==s.turnOwner?'active-player':''}">${p.name}: ${p.score}</div>`).join('');
        });
        socket.on('new-word-on-board', d => {
            if(d.bingo) { 
                document.getElementById('bingo').style.display='block';
                setTimeout(()=>document.getElementById('bingo').style.display='none', 2000);
            }
            d.word.split('').forEach((l, i) => {
                const x = d.vertical ? d.x : parseInt(d.x)+i, y = d.vertical ? parseInt(d.y)+i : d.y;
                document.getElementById(`cell-${x}-${y}`).innerText = l.toUpperCase();
                document.getElementById(`cell-${x}-${y}`).style.background = "#f1c40f";
            });
        });
    </script>
</body>
</html>
